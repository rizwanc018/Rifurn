<div class="container">
    <div class="row text-center mb-1">
        <h3 class="fw-bolder mb-0">Categories</h3>
    </div>
</div>
<hr>
<div class="container">
    <div class="row justify-content-end mb-3">
        {{!-- <a href="/admin/adduser" class="btn btn-success col-3 me-3 small">
            <i class="fa-solid fa-plus"></i>
            Add Category
        </a> --}}
        <a class="btn btn-success col-3 me-3" data-bs-toggle="modal" data-bs-target="#addCategoryModal" href="#"><i
                class="fa-solid fa-plus"></i>
            Add Category</a>
    </div>

    <div class="row">
        <table id="usersTable datatables" class="table  mb-0">
            <thead>
                <tr>
                    <th scope="col">Id</th>
                    <th scope="col">Category</th>
                    <th scope="col"></th>
                </tr>
            </thead>
            <tbody>
                {{#each categories }}
                <tr>
                    <th scope="row" class="nr">{{inc @index}}</th>
                    <td>{{category}}</td>
                    <td>
                        <a class="btn btn-primary btn-sm px-2" href="/admin/edit/{{_id}}"><i
                                class="fa fa-pen-to-square"></i>
                        </a>
                        <a class="btn btn-danger btn-sm px-2"
                            onclick="return confirm('are you sure you want to delete {{category}}?')"
                            href="/admin/delete/{{_id}}"><i class="fa fa-trash"></i></a>
                    </td>

                </tr>
                {{/each}}
            </tbody>
        </table>
    </div>
</div>


<div class="modal fade" id="addCategoryModal" tabindex="-1" aria-labelledby="loginModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-title text-center">
                    <h4>Add Category</h4>
                </div>
                <div class="d-flex flex-column text-center">
                    <form action="">
                        <div class="form-group">
                            <input type="text" class="form-control" id="category" placeholder="Category. . ." required
                                value="">
                        </div>
                        <div class="my-3"></div>
                        <button type="submit" class="btn btn-primary btn-block btn-round">Add category</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const addCategoryform = document.querySelector('#addCategoryModal')
    let url = window.location.origin
    addCategoryform.addEventListener('submit', e => {
        let category = document.querySelector('#category')
        e.preventDefault();
        $.ajax({
            url: `${url}/admin/addcategoty`,
            method: "POST",
            data: { category: category.value },
            success: res => {
                console.log(res)
                alert(res)
                category.value = ""
            },
            error: err => {
                console.log(err)
                alert(err)
            }
        })
    })
</script>